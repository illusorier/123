JavaScript是单线程的，也就是说，同一时间只能做一件事。

问题来了，为什么JavaScript不设计成多线程的呢？

这与它的用途有关，作为浏览器的脚本语言，JS的主要用途是与用户交互，更新DOM，发起请求等等。

但要注意的一点是，浏览器并不是单线程的！

所有任务可以分成两种，一种是同步任务(synchronous)，另一种是异步任务(asynchronous)。

同步任务指的是，在主线程上排队执行的任务，只有前一个任务执行完毕，才能执行后一个任务；异步任务指的是，不进入主线程、而进入“任务队列”(task queue)的任务，只有“任务队列”通知主线程，某个异步任务可以执行了，该任务才会进入主线程执行。

![](./assets/event-loop.png)

事件驱动编程

In computer programming, **event-driven programming** is a programming paradigm in which the **flow of the program** is determined by events such as user actions ....

JavaScript has a concurrency modal based on an "event loop".

##### Stack

Function calls form a stack of *frames*.

##### Queue

A JavaScript runtime contains a message queue, which is a list of messages to be processed.

A function is associated with each message.

You browser is one big infinite loop.

    while (queue.waitForMessage()) {
      queue.processNextMessage();
    }

`queue.waitForMessage` waits synchronously for a message to arrive if there is none currently.

##### Adding messages

In  web browsers, messages are added anytime an event occurs and there is 

It's waiting for you to do things all the time and, when you do, it fires off "Events" to describe what you just did.

Some events are generated by the user, like

You
    
##### Why We Need Asynchronous Behavior in the Browser

This asynchronous behavior is necessary because the kinds of events that JavaScript works with are often either time consuming (HTTP request) or highly intermittent

JavaScript is **single-threaded** yet it mimics the behavior of a multithreaded process by efficiently using its time 

The **Call Stack** contains the list of 

JavaScript has 

The *event loop* got

##### "Run-to-completion"

Each message is processed

![](./assets/Timers.png)

JavaScript can only ever execute one piece of code at a time (due to its single-threaded nature). 

This means that when an asynchronous event occurs (like )

[示例][1]

[1]:https://jsfiddle.net/op3Lmkga/

#### Microtasks and Macrotasks

It turns out that not all tasks are created the same.

There are macrotasks and microtasks.

